<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SkyLy - Air Quality Monitoring</title>
    <link rel="stylesheet" href="style.css?v=10">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
</head>
<body>
    <!-- Animated Background -->
    <div class="background-animation">
        <div class="particle"></div>
        <div class="particle"></div>
        <div class="particle"></div>
        <div class="particle"></div>
        <div class="particle"></div>
    </div>

    <!-- Header -->
    <header class="header">
        <div class="container">
                <div class="logo">
                <i class="fas fa-wind"></i>
                <span>SkyLy</span>
            </div>
            <nav class="nav">
                <a href="#dashboard" class="nav-link" data-section="dashboard">
                    <i class="fas fa-home"></i> Dashboard
                </a>
                <a href="#live" class="nav-link active" data-section="live">
                    <i class="fas fa-broadcast-tower"></i> Live AQI
                </a>
                <a href="#map" class="nav-link" data-section="map">
                    <i class="fas fa-map-marked-alt"></i> India Map
                </a>
                <a href="#ranking" class="nav-link" data-section="ranking">
                    <i class="fas fa-trophy"></i> City Ranking
                </a>
                <a href="#analytics" class="nav-link" data-section="analytics">
                    <i class="fas fa-chart-line"></i> Analytics
                </a>
                <a href="#historical" class="nav-link" data-section="historical">
                    <i class="fas fa-history"></i> Historical
                </a>
                <a href="#compare" class="nav-link" data-section="compare">
                    <i class="fas fa-balance-scale"></i> Compare
                </a>
                <a href="#location" class="nav-link" data-section="location">
                    <i class="fas fa-map-marker-alt"></i> Nearby
                </a>
                <a href="#predict" class="nav-link" data-section="predict">
                    <i class="fas fa-brain"></i> Predict
                </a>
            </nav>
            <div class="header-actions">
                <button id="chatbot-toggle" class="icon-btn" title="AI Assistant">
                    <i class="fas fa-robot"></i>
                </button>
                <button id="user-menu-toggle" class="icon-btn" title="Account">
                    <i class="fas fa-user"></i>
                </button>
                <button id="theme-toggle" class="theme-toggle">
                    <i class="fas fa-moon"></i>
                </button>
            </div>
        </div>
    </header>

    <!-- User Menu Dropdown -->
    <div id="user-menu" class="user-menu hidden">
        <div class="user-menu-guest" id="guest-menu">
            <button class="btn-menu" id="login-btn">
                <i class="fas fa-sign-in-alt"></i> Login
            </button>
            <button class="btn-menu" id="register-btn">
                <i class="fas fa-user-plus"></i> Register
            </button>
        </div>
        <div class="user-menu-auth hidden" id="auth-menu">
            <div class="user-info">
                <i class="fas fa-user-circle"></i>
                <span id="user-name">User</span>
            </div>
            <button class="btn-menu" id="goto-dashboard">
                <i class="fas fa-home"></i> My Dashboard
            </button>
            <button class="btn-menu" id="logout-btn">
                <i class="fas fa-sign-out-alt"></i> Logout
            </button>
        </div>
    </div>

    <!-- Login Modal -->
    <div id="login-modal" class="modal hidden">
        <div class="modal-content">
            <button class="modal-close">&times;</button>
            <h2><i class="fas fa-sign-in-alt"></i> Login to Your Account</h2>
            <form id="login-form">
                <div class="form-group">
                    <label><i class="fas fa-envelope"></i> Email</label>
                    <input type="email" id="login-email" required placeholder="your@email.com">
                </div>
                <div class="form-group">
                    <label><i class="fas fa-lock"></i> Password</label>
                    <input type="password" id="login-password" required placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢">
                </div>
                <div class="form-actions">
                    <button type="submit" class="btn btn-primary">
                        <i class="fas fa-sign-in-alt"></i> Login
                    </button>
                    <button type="button" class="btn btn-secondary modal-close-btn">
                        <i class="fas fa-times"></i> Cancel
                    </button>
                </div>
            </form>
            <p class="modal-footer">
                Don't have an account? <a href="#" id="switch-to-register">Register here</a>
            </p>
        </div>
    </div>

    <!-- Register Modal -->
    <div id="register-modal" class="modal hidden">
        <div class="modal-content">
            <button class="modal-close">&times;</button>
            <h2><i class="fas fa-user-plus"></i> Create New Account</h2>
            <form id="register-form">
                <div class="form-group">
                    <label><i class="fas fa-user"></i> Full Name</label>
                    <input type="text" id="register-name" required placeholder="John Doe">
                </div>
                <div class="form-group">
                    <label><i class="fas fa-envelope"></i> Email</label>
                    <input type="email" id="register-email" required placeholder="your@email.com">
                </div>
                <div class="form-group">
                    <label><i class="fas fa-lock"></i> Password</label>
                    <input type="password" id="register-password" required placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢" minlength="6">
                </div>
                <div class="form-actions">
                    <button type="submit" class="btn btn-primary">
                        <i class="fas fa-user-plus"></i> Create Account
                    </button>
                    <button type="button" class="btn btn-secondary modal-close-btn">
                        <i class="fas fa-times"></i> Cancel
                    </button>
                </div>
            </form>
            <p class="modal-footer">
                Already have an account? <a href="#" id="switch-to-login">Login here</a>
            </p>
        </div>
    </div>

    <!-- Chatbot Widget -->
    <div id="chatbot-widget" class="chatbot-widget hidden">
        <div class="chatbot-header">
            <h3><i class="fas fa-robot"></i> AI Assistant</h3>
            <button id="chatbot-close" class="chatbot-close">&times;</button>
        </div>
        <div class="chatbot-messages" id="chatbot-messages">
            <div class="chatbot-message bot">
                <i class="fas fa-robot"></i>
                <div class="message-content">
                    Hi! I can help you with air quality questions. Try asking:
                    <ul>
                        <li>"What's the AQI in Delhi?"</li>
                        <li>"Is it safe to jog in Mumbai?"</li>
                        <li>"Compare Delhi and Bangalore"</li>
                    </ul>
                </div>
            </div>
        </div>
        <form id="chatbot-form" class="chatbot-input">
            <input type="text" id="chatbot-input" placeholder="Ask me anything..." required>
            <button type="submit"><i class="fas fa-paper-plane"></i></button>
        </form>
    </div>

    <!-- Main Content -->
    <main class="main-content">
        <div class="container">
            
            <!-- Dashboard Section (User's Personal Dashboard) -->
            <section id="dashboard" class="section">
                <div class="section-header">
                    <h1 class="section-title">
                        <i class="fas fa-home"></i>
                        My Dashboard
                    </h1>
                    <p class="section-subtitle">Your personalized air quality monitoring center</p>
                </div>

                <div class="dashboard-grid">
                    <div class="dashboard-card">
                        <h3><i class="fas fa-star"></i> Favorite Cities</h3>
                        <div id="favorites-list" class="favorites-list">
                            <p class="empty-state">Login to save your favorite cities</p>
                        </div>
                    </div>

                    <div class="dashboard-card">
                        <h3><i class="fas fa-chart-line"></i> Quick Stats</h3>
                        <div id="dashboard-stats" class="dashboard-stats">
                            <div class="stat-item">
                                <i class="fas fa-city"></i>
                                <div>
                                    <span class="stat-value" id="stat-cities">0</span>
                                    <span class="stat-label">Cities Tracked</span>
                                </div>
                            </div>
                            <div class="stat-item">
                                <i class="fas fa-check-circle"></i>
                                <div>
                                    <span class="stat-value" id="stat-good">0</span>
                                    <span class="stat-label">Good AQI</span>
                                </div>
                            </div>
                            <div class="stat-item">
                                <i class="fas fa-exclamation-triangle"></i>
                                <div>
                                    <span class="stat-value" id="stat-bad">0</span>
                                    <span class="stat-label">Unhealthy</span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Live AQI Section -->
            <section id="live" class="section active">
                <div class="section-header">
                    <h1 class="section-title">
                        <i class="fas fa-broadcast-tower"></i>
                        Real-Time AQI Monitor
                    </h1>
                    <p class="section-subtitle">Get instant air quality data for any city worldwide</p>
                </div>

                <div class="input-card">
                    <div class="input-group">
                        <i class="fas fa-search input-icon"></i>
                        <input 
                            type="text" 
                            id="live-city-input" 
                            placeholder="Enter city name (e.g., Delhi, Mumbai, Chennai)"
                            class="city-input"
                        >
                        <button id="fetch-live-btn" class="btn btn-primary">
                            <i class="fas fa-location-arrow"></i> Get Live AQI
                        </button>
                    </div>
                </div>

                <div id="live-result" class="result-container hidden">
                    <div class="aqi-card-large">
                        <div class="aqi-header">
                            <h2 id="live-city-name">--</h2>
                            <span id="live-timestamp" class="timestamp">--</span>
                        </div>
                        
                        <div class="aqi-main">
                            <div class="aqi-gauge-container">
                                <div class="aqi-gauge">
                                    <svg class="gauge-svg" viewBox="0 0 200 120">
                                        <path class="gauge-bg" d="M 20 100 A 80 80 0 0 1 180 100" fill="none" stroke="#e5e7eb" stroke-width="12" stroke-linecap="round"/>
                                        <path class="gauge-progress" id="gauge-progress" d="M 20 100 A 80 80 0 0 1 180 100" fill="none" stroke="url(#gaugeGradient)" stroke-width="12" stroke-linecap="round" stroke-dasharray="251.2" stroke-dashoffset="251.2"/>
                                        <defs>
                                            <linearGradient id="gaugeGradient" x1="0%" y1="0%" x2="100%" y2="0%">
                                                <stop offset="0%" style="stop-color:#10b981;stop-opacity:1" />
                                                <stop offset="50%" style="stop-color:#f59e0b;stop-opacity:1" />
                                                <stop offset="100%" style="stop-color:#ef4444;stop-opacity:1" />
                                            </linearGradient>
                                        </defs>
                                    </svg>
                                    <div class="gauge-value">
                                        <div class="aqi-value" id="live-aqi-value">--</div>
                                        <div class="aqi-label">AQI</div>
                                    </div>
                                </div>
                                <div class="aqi-status">
                                    <div id="live-aqi-category" class="aqi-category">--</div>
                                    <div id="live-aqi-description" class="aqi-description">--</div>
                                </div>
                            </div>
                            <div class="aqi-details">
                                <div class="dominant-pollutant">
                                    <i class="fas fa-exclamation-triangle"></i>
                                    Dominant: <span id="live-dominant">--</span>
                                </div>
                                <div class="section-subtitle" style="margin-top:0.75rem;font-size:0.9rem;">
                                    Ground data from monitoring stations. Satellite/model estimates will appear in separate tiles below.
                                </div>
                            </div>
                        </div>

                        <div class="pollutants-grid" id="pollutants-grid">
                            <!-- Dynamically populated (ground + satellite tiles via JS) -->
                        </div>
                    </div>

                    <!-- Action Buttons -->
                    <div style="display: flex; gap: 1rem; margin-top: 1.5rem; flex-wrap: wrap;">
                        <button id="view-stations-btn" class="btn btn-secondary">
                            <i class="fas fa-broadcast-tower"></i> View All Monitoring Stations
                        </button>
                        <button id="add-favorite-btn" class="btn btn-success" style="display: none;">
                            <i class="fas fa-star"></i> Add to Favorites
                        </button>
                    </div>

                    <!-- Stations List (Hidden by default) -->
                    <div id="stations-container" class="hidden" style="margin-top:1.5rem;">
                        <div class="section-subtitle" style="margin-bottom:1rem;">
                            <i class="fas fa-map-pin"></i> All Monitoring Stations
                        </div>
                        <div id="stations-grid" class="pollutants-grid">
                            <!-- Dynamically populated with station data -->
                        </div>
                    </div>

                    <!-- NEW: Alert Rules Panel -->
                    <div class="input-card" id="alerts-card">
                        <div class="section-subtitle" style="margin-bottom:1rem;">
                            Set AQI alerts for this city
                        </div>
                        <div class="alert-form">
                            <div class="input-group-vertical">
                                <label for="alert-city">
                                    <i class="fas fa-city"></i> City
                                </label>
                                <input type="text" id="alert-city" placeholder="Will auto-fill after a live search" readonly>
                            </div>
                            <div class="input-group-vertical">
                                <label for="alert-threshold">
                                    <i class="fas fa-arrow-up"></i> Alert when AQI exceeds
                                </label>
                                <input type="number" id="alert-threshold" min="0" placeholder="e.g., 150">
                            </div>
                            <div class="alert-time-row">
                                <div class="input-group-vertical">
                                    <label for="alert-start">
                                        <i class="fas fa-clock"></i> Start time
                                    </label>
                                    <input type="time" id="alert-start">
                                </div>
                                <div class="input-group-vertical">
                                    <label for="alert-end">
                                        <i class="fas fa-clock"></i> End time
                                    </label>
                                    <input type="time" id="alert-end">
                                </div>
                            </div>
                            <div class="alert-channel-row">
                                <div class="input-group-vertical">
                                    <label for="alert-channel">
                                        <i class="fas fa-bell"></i> Channel
                                    </label>
                                    <select id="alert-channel" class="city-select">
                                        <option value="browser">Browser notification</option>
                                        <option value="email">Email</option>
                                        <option value="whatsapp">WhatsApp</option>
                                        <option value="telegram">Telegram</option>
                                    </select>
                                </div>
                                <div class="input-group-vertical">
                                    <label for="alert-contact">
                                        <i class="fas fa-address-card"></i> Contact (optional for browser)
                                    </label>
                                    <input type="text" id="alert-contact" placeholder="Email / phone / handle">
                                </div>
                            </div>
                            <button id="save-alert-btn" class="btn btn-primary" style="margin-top:1.5rem;">
                                <i class="fas fa-bell"></i> Save Alert
                            </button>
                            <div id="alert-message" class="error-message hidden"></div>
                        </div>
                    </div>

                    <!-- NEW: Daily Summary Subscription -->
                    <div class="input-card" id="daily-summary-card">
                        <div class="section-subtitle" style="margin-bottom:1rem;">
                            Get daily AQI summary for your city
                        </div>
                        <div class="alert-form">
                            <div class="input-group-vertical">
                                <label for="digest-city">
                                    <i class="fas fa-city"></i> City
                                </label>
                                <input type="text" id="digest-city" placeholder="e.g., Delhi">
                            </div>
                            <div class="input-group-vertical">
                                <label for="digest-time">
                                    <i class="fas fa-clock"></i> Preferred time
                                </label>
                                <input type="time" id="digest-time">
                            </div>
                            <div class="input-group-vertical">
                                <label for="digest-channel">
                                    <i class="fas fa-paper-plane"></i> Channel
                                </label>
                                <select id="digest-channel" class="city-select">
                                    <option value="email">Email</option>
                                    <option value="whatsapp">WhatsApp</option>
                                    <option value="telegram">Telegram</option>
                                </select>
                            </div>
                            <div class="input-group-vertical">
                                <label for="digest-contact">
                                    <i class="fas fa-address-card"></i> Email / Phone / Handle
                                </label>
                                <input type="text" id="digest-contact" placeholder="Your email or phone">
                            </div>
                            <button id="subscribe-digest-btn" class="btn btn-primary" style="margin-top:1.5rem;">
                                <i class="fas fa-envelope-open-text"></i> Subscribe Daily Summary
                            </button>
                            <div id="digest-message" class="error-message hidden"></div>
                        </div>
                    </div>

                    <!-- NEW: Share Live AQI -->
                    <button id="share-live-btn" class="btn btn-primary" style="margin-top:1.5rem;">
                        <i class="fas fa-share"></i> Send this live AQI to my email/WhatsApp
                    </button>

                    <div class="input-card" id="share-live-form" style="margin-top:1rem; display:none;">
                        <div class="alert-form">
                            <div class="input-group-vertical">
                                <label for="share-live-channel">
                                    <i class="fas fa-paper-plane"></i> Channel
                                </label>
                                <select id="share-live-channel" class="city-select">
                                    <option value="email">Email</option>
                                    <option value="whatsapp">WhatsApp</option>
                                </select>
                            </div>
                            <div class="input-group-vertical">
                                <label for="share-live-contact">
                                    <i class="fas fa-address-book"></i> Email / Phone
                                </label>
                                <input type="text" id="share-live-contact" placeholder="Enter email or phone">
                            </div>
                            <button id="share-live-submit" class="btn btn-primary" style="margin-top:1rem;">
                                <i class="fas fa-paper-plane"></i> Send
                            </button>
                            <div id="share-live-message" class="error-message hidden"></div>
                        </div>
                    </div>

                </div>

                <div id="live-error" class="error-message hidden"></div>
            </section>

            <!-- India Map Section -->
            <section id="map" class="section">
                <div class="section-header">
                    <h1 class="section-title">
                        <i class="fas fa-map-marked-alt"></i>
                        Interactive India AQI Map
                    </h1>
                    <p class="section-subtitle">
                        Real-time air quality data across Indian cities. Use the toggle to switch between ground AQI and satellite/model aerosol view.
                    </p>
                </div>

                <!-- NEW: Ground vs Satellite toggle buttons -->
                <div class="input-card" style="margin-bottom:1.5rem;">
                    <div class="input-group" style="justify-content:center; gap:1rem;">
                        <button id="ground-map-toggle" class="btn btn-primary">
                            <i class="fas fa-map"></i> Ground AQI Map
                        </button>
                        <button id="satellite-map-toggle" class="btn">
                            <i class="fas fa-satellite-dish"></i> Satellite Dust / PM Map
                        </button>
                    </div>
                    <p class="section-subtitle" style="margin-top:0.75rem;font-size:0.9rem;text-align:center;">
                        Ground map uses station-based AQI. Satellite map uses Open‚ÄëMeteo modelled dust/PM and AQI indices (US/EU).
                    </p>
                </div>

                <div class="map-container">
                    <!-- Original ground AQI map -->
                    <div id="india-map" class="map-view"></div>

                    <!-- NEW: satellite/model map, initially hidden -->
                    <div id="india-aod-map" class="map-view" style="display:none;"></div>

                    <div class="map-legend">
                        <h4><i class="fas fa-info-circle"></i> AQI Scale</h4>
                        <div class="legend-items">
                            <div class="legend-item">
                                <div class="legend-color good"></div>
                                <span>Good (0-50)</span>
                            </div>
                            <div class="legend-item">
                                <div class="legend-color moderate"></div>
                                <span>Moderate (51-100)</span>
                            </div>
                            <div class="legend-item">
                                <div class="legend-color unhealthy-sensitive"></div>
                                <span>Unhealthy for Sensitive (101-150)</span>
                            </div>
                            <div class="legend-item">
                                <div class="legend-color unhealthy"></div>
                                <span>Unhealthy (151-200)</span>
                            </div>
                            <div class="legend-item">
                                <div class="legend-color very-unhealthy"></div>
                                <span>Very Unhealthy (201-300)</span>
                            </div>
                            <div class="legend-item">
                                <div class="legend-color hazardous"></div>
                                <span>Hazardous (300+)</span>
                            </div>
                        </div>
                    </div>
                </div>

                <div id="map-error" class="error-message hidden"></div>
            </section>

            <!-- City Ranking Section -->
            <section id="ranking" class="section">
                <div class="section-header">
                    <h1 class="section-title">
                        <i class="fas fa-trophy"></i>
                        City AQI Ranking
                    </h1>
                    <p class="section-subtitle">Live ranking of Indian cities by air quality</p>
                </div>

                <div class="ranking-controls">
                    <button id="refresh-ranking-btn" class="btn btn-primary">
                        <i class="fas fa-sync-alt"></i> Refresh Rankings
                    </button>
                    <div class="ranking-info">
                        <span id="ranking-timestamp">Last updated: --</span>
                    </div>
                </div>

                <div id="ranking-result" class="result-container">
                    <div class="ranking-card">
                        <div class="ranking-header">
                            <h3><i class="fas fa-list-ol"></i> Live City Rankings</h3>
                        </div>
                        <div id="ranking-list" class="ranking-list">
                            <!-- Dynamically populated -->
                        </div>
                    </div>
                </div>

                <div id="ranking-error" class="error-message hidden"></div>
            </section>

            <!-- Analytics Section -->
            <section id="analytics" class="section">
                <div class="section-header">
                    <h1 class="section-title">
                        <i class="fas fa-chart-line"></i>
                        Historical AQI Analytics
                    </h1>
                    <p class="section-subtitle">Analyze past year pollution trends and patterns</p>
                </div>

                <div class="input-card">
                    <div class="input-group">
                        <i class="fas fa-city input-icon"></i>
                        <select id="analytics-city-select" class="city-select">
                            <option value="">Select a city</option>
                        </select>
                        <button id="fetch-analytics-btn" class="btn btn-primary">
                            <i class="fas fa-chart-area"></i> Analyze
                        </button>
                    </div>
                </div>

                <div id="analytics-result" class="result-container hidden">
                    <div class="insights-card">
                        <h3><i class="fas fa-lightbulb"></i> Key Insights</h3>
                        <div class="insights-grid" id="analytics-insights">
                            <!-- Dynamically populated -->
                        </div>
                    </div>

                    <div class="chart-card">
                        <h3><i class="fas fa-chart-line"></i> AQI Trend - Last 12 Months</h3>
                        <canvas id="analytics-chart"></canvas>
                    </div>
                </div>

                <div id="analytics-error" class="error-message hidden"></div>
            </section>

            <!-- Historical Analysis Section -->
            <section id="historical" class="section">
                <div class="section-header">
                    <h1 class="section-title">
                        <i class="fas fa-history"></i>
                        Historical Analysis
                    </h1>
                    <p class="section-subtitle">Explore past trends, seasonal patterns, and long-term data</p>
                </div>

                <div class="input-card">
                    <div class="input-group">
                        <i class="fas fa-city input-icon"></i>
                        <select id="historical-city-select" class="city-select">
                            <option value="">Select a city</option>
                        </select>
                        <button id="fetch-historical-btn" class="btn btn-primary">
                            <i class="fas fa-chart-area"></i> Analyze
                        </button>
                    </div>
                </div>

                <div id="historical-result" class="result-container hidden">
                    <div class="tabs-container">
                        <div class="tabs">
                            <button class="tab-btn active" data-tab="yearly">Year-over-Year</button>
                            <button class="tab-btn" data-tab="seasonal">Seasonal Trends</button>
                            <button class="tab-btn" data-tab="best-worst">Best/Worst Times</button>
                        </div>
                    </div>

                    <div class="tab-content active" data-tab="yearly">
                        <div class="chart-card">
                            <h3><i class="fas fa-calendar-alt"></i> Yearly AQI Comparison</h3>
                            <canvas id="yearly-chart"></canvas>
                        </div>
                    </div>

                    <div class="tab-content" data-tab="seasonal">
                        <div class="insights-grid">
                            <div class="insight-item" id="winter-data">
                                <span class="insight-label">‚ùÑÔ∏è Winter</span>
                                <span class="insight-value">--</span>
                            </div>
                            <div class="insight-item" id="spring-data">
                                <span class="insight-label">üå∏ Spring</span>
                                <span class="insight-value">--</span>
                            </div>
                            <div class="insight-item" id="summer-data">
                                <span class="insight-label">‚òÄÔ∏è Summer</span>
                                <span class="insight-value">--</span>
                            </div>
                            <div class="insight-item" id="autumn-data">
                                <span class="insight-label">üçÇ Autumn</span>
                                <span class="insight-value">--</span>
                            </div>
                        </div>
                    </div>

                    <div class="tab-content" data-tab="best-worst">
                        <div class="comparison-grid">
                            <div class="comparison-card">
                                <h4><i class="fas fa-smile"></i> Best Months</h4>
                                <div id="best-months-list"></div>
                            </div>
                            <div class="comparison-card">
                                <h4><i class="fas fa-frown"></i> Worst Months</h4>
                                <div id="worst-months-list"></div>
                            </div>
                        </div>
                    </div>
                </div>

                <div id="historical-error" class="error-message hidden"></div>
            </section>

            <!-- Location Services Section -->
            <section id="location" class="section">
                <div class="section-header">
                    <h1 class="section-title">
                        <i class="fas fa-map-marker-alt"></i>
                        Location-Based Services
                    </h1>
                    <p class="section-subtitle">Find nearby stations and safe zones around you</p>
                </div>

                <div class="location-cards-grid">
                    <div class="location-card">
                        <h3><i class="fas fa-crosshairs"></i> Auto-Detect Location</h3>
                        <button id="detect-location-btn" class="btn btn-primary btn-block">
                            <i class="fas fa-location-arrow"></i> Use My Location
                        </button>
                        <p class="location-status" id="location-status">Click to detect your location</p>
                    </div>

                    <div class="location-card">
                        <h3><i class="fas fa-broadcast-tower"></i> Nearby Stations</h3>
                        <div class="input-group-vertical">
                            <label>Search Radius (km)</label>
                            <input type="number" id="radius-input" value="50" min="10" max="200" step="10">
                        </div>
                        <button id="find-nearby-btn" class="btn btn-secondary btn-block">
                            <i class="fas fa-search"></i> Find Stations
                        </button>
                    </div>

                    <div class="location-card">
                        <h3><i class="fas fa-shield-alt"></i> Safe Zones</h3>
                        <div class="input-group-vertical">
                            <label>AQI Threshold</label>
                            <input type="number" id="threshold-input" value="100" min="50" max="200" step="10">
                        </div>
                        <button id="find-safe-zones-btn" class="btn btn-success btn-block">
                            <i class="fas fa-check"></i> Find Safe Zones
                        </button>
                    </div>
                </div>

                <div id="location-result" class="result-container hidden">
                    <div class="ranking-card">
                        <h3 id="location-result-title"><i class="fas fa-list"></i> Results</h3>
                        <div id="location-result-list" class="ranking-list"></div>
                    </div>
                </div>

                <div id="location-error" class="error-message hidden"></div>
            </section>

            <!-- Compare Section -->
            <section id="compare" class="section">
                <div class="section-header">
                    <h1 class="section-title">
                        <i class="fas fa-balance-scale"></i>
                        Multi-City Comparison
                    </h1>
                    <p class="section-subtitle">Compare up to 5 cities simultaneously</p>
                </div>

                <div class="input-card">
                    <h3><i class="fas fa-city"></i> Select Cities to Compare</h3>
                    <div class="multi-city-inputs">
                        <select id="compare-city1" class="city-select">
                            <option value="">City 1</option>
                        </select>
                        <select id="compare-city2" class="city-select">
                            <option value="">City 2</option>
                        </select>
                        <select id="compare-city3" class="city-select">
                            <option value="">City 3 (Optional)</option>
                        </select>
                        <select id="compare-city4" class="city-select">
                            <option value="">City 4 (Optional)</option>
                        </select>
                        <select id="compare-city5" class="city-select">
                            <option value="">City 5 (Optional)</option>
                        </select>
                    </div>
                    <button id="fetch-multi-compare-btn" class="btn btn-primary">
                        <i class="fas fa-exchange-alt"></i> Compare Cities
                    </button>
                </div>

                <div id="multi-compare-result" class="result-container hidden">
                    <div class="comparison-grid-multi" id="comparison-grid">
                        <!-- Dynamically populated -->
                    </div>
                </div>

                <div class="input-card">
                    <h3><i class="fas fa-plane-departure"></i> Migration Advisor</h3>
                    <p>Find better cities to move to based on air quality</p>
                    <div class="input-group">
                        <i class="fas fa-city input-icon"></i>
                        <select id="migration-city-select" class="city-select">
                            <option value="">Select your current city</option>
                        </select>
                        <button id="fetch-migration-btn" class="btn btn-success">
                            <i class="fas fa-search"></i> Find Better Cities
                        </button>
                    </div>
                </div>

                <div id="migration-result" class="result-container hidden">
                    <div class="ranking-card">
                        <h3><i class="fas fa-trophy"></i> Recommended Cities</h3>
                        <div id="migration-list" class="ranking-list"></div>
                    </div>
                </div>

                <div id="compare-error" class="error-message hidden"></div>
            </section>

            <!-- Predict Section -->
            <section id="predict" class="section">
                <div class="section-header">
                    <h1 class="section-title">
                        <i class="fas fa-brain"></i>
                        AI-Powered AQI Prediction
                    </h1>
                    <p class="section-subtitle">Predict AQI using pollutant concentrations with XGBoost ML</p>
                </div>

                <div class="input-card">
                    <div class="pollutant-inputs">
                        <div class="input-group-vertical">
                            <label for="pm25-input">
                                <i class="fas fa-smog"></i> PM2.5 (¬µg/m¬≥)
                            </label>
                            <input type="number" id="pm25-input" placeholder="e.g., 45.5" step="0.1" min="0">
                        </div>
                        
                        <div class="input-group-vertical">
                            <label for="pm10-input">
                                <i class="fas fa-cloud"></i> PM10 (¬µg/m¬≥)
                            </label>
                            <input type="number" id="pm10-input" placeholder="e.g., 78.2" step="0.1" min="0">
                        </div>
                        
                        <div class="input-group-vertical">
                            <label for="no2-input">
                                <i class="fas fa-industry"></i> NO‚ÇÇ (ppb)
                            </label>
                            <input type="number" id="no2-input" placeholder="e.g., 25.0" step="0.1" min="0">
                        </div>
                        
                        <div class="input-group-vertical">
                            <label for="so2-input">
                                <i class="fas fa-fire"></i> SO‚ÇÇ (ppb)
                            </label>
                            <input type="number" id="so2-input" placeholder="e.g., 12.5" step="0.1" min="0">
                        </div>
                        
                        <div class="input-group-vertical">
                            <label for="co-input">
                                <i class="fas fa-car"></i> CO (ppm)
                            </label>
                            <input type="number" id="co-input" placeholder="e.g., 1.2" step="0.1" min="0">
                        </div>
                        
                        <div class="input-group-vertical">
                            <label for="o3-input">
                                <i class="fas fa-sun"></i> O‚ÇÉ (ppb)
                            </label>
                            <input type="number" id="o3-input" placeholder="e.g., 30.0" step="0.1" min="0">
                        </div>
                    </div>
                    
                    <button id="predict-btn" class="btn btn-primary">
                        <i class="fas fa-robot"></i> Predict AQI
                    </button>
                </div>

                <div id="predict-result" class="result-container hidden">
                    <div class="prediction-card">
                        <h3><i class="fas fa-calculator"></i> Prediction Result</h3>
                        <div class="prediction-display">
                            <div class="predicted-aqi">
                                <div class="predicted-value" id="predicted-aqi-value">--</div>
                                <div class="predicted-label">Predicted AQI</div>
                            </div>
                            <div class="predicted-category" id="predicted-category">--</div>
                        </div>
                        <div class="prediction-note" id="prediction-note"></div>
                    </div>
                </div>

                <div id="predict-error" class="error-message hidden"></div>
            </section>

            <!-- NEW: Widget Embed Section -->
            <section id="widget" class="section">
                <div class="section-header">
                    <h1 class="section-title">
                        <i class="fas fa-code"></i>
                        Embed AQI Widget
                    </h1>
                    <p class="section-subtitle">Add a live AQI card to your website using a simple iframe</p>
                </div>

                <div class="input-card">
                    <p class="section-subtitle" style="margin-bottom:1rem;">
                        Copy and paste this code into your website (change <strong>Delhi</strong> to any city you want):
                    </p>
                    <textarea readonly style="width:100%;height:90px;border-radius:12px;padding:0.75rem;font-family:monospace;">
<iframe src="https://air-pollution-app-5yc8.onrender.com/widget?city=Delhi"
        style="border:0;width:240px;height:140px;border-radius:12px;"></iframe>
                    </textarea>
                </div>
            </section>

        </div>
    </main>

    <!-- Footer -->
    <footer class="footer">
        <div class="container">
            <p>&copy; 2025 Air Quality Intelligence Platform | Powered by Syed Muhammad Rizvi And Ishan Singh</p>
        </div>
    </footer>

    <!-- Loading Overlay -->
    <div id="loading-overlay" class="loading-overlay hidden">
        <div class="spinner"></div>
        <p>Loading data...</p>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
    <script src="script.js"></script>
    <script src="auth.js"></script>
    <script src="features.js"></script>
</body>
</html>
